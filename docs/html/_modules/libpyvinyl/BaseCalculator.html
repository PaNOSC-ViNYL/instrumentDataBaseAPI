<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>libpyvinyl.BaseCalculator &mdash; instrumentdatabaseapi 0.1.0 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> instrumentdatabaseapi
          </a>
              <div class="version">
                0.1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../include/notebooks/example-01.html">Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../include/refman.html">Reference Manual</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">instrumentdatabaseapi</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../index.html">Module code</a> &raquo;</li>
      <li>libpyvinyl.BaseCalculator</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for libpyvinyl.BaseCalculator</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">:module BaseCalculator: Module hosting the BaseCalculator class.</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="c1">####################################################################################</span>
<span class="c1">#                                                                                  #</span>
<span class="c1"># This file is part of libpyvinyl - The APIs for Virtual Neutron and x-raY         #</span>
<span class="c1"># Laboratory.                                                                      #</span>
<span class="c1">#                                                                                  #</span>
<span class="c1"># Copyright (C) 2021  Carsten Fortmann-Grote, Juncheng E                           #</span>
<span class="c1">#                                                                                  #</span>
<span class="c1"># This program is free software: you can redistribute it and/or modify it under    #</span>
<span class="c1"># the terms of the GNU Lesser General Public License as published by the Free      #</span>
<span class="c1"># Software Foundation, either version 3 of the License, or (at your option) any    #</span>
<span class="c1"># later version.                                                                   #</span>
<span class="c1">#                                                                                  #</span>
<span class="c1"># This program is distributed in the hope that it will be useful, but WITHOUT ANY  #</span>
<span class="c1"># WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A  #</span>
<span class="c1"># PARTICULAR PURPOSE.  See the GNU Lesser General Public License for more details. #</span>
<span class="c1">#                                                                                  #</span>
<span class="c1"># You should have received a copy of the GNU Lesser General Public License along   #</span>
<span class="c1"># with this program.  If not, see &lt;https://www.gnu.org/licenses/                   #</span>
<span class="c1">#                                                                                  #</span>
<span class="c1">####################################################################################</span>

<span class="kn">from</span> <span class="nn">abc</span> <span class="kn">import</span> <span class="n">abstractmethod</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Union</span><span class="p">,</span> <span class="n">Optional</span>
<span class="kn">from</span> <span class="nn">tempfile</span> <span class="kn">import</span> <span class="n">mkstemp</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">dill</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="kn">from</span> <span class="nn">libpyvinyl.AbstractBaseClass</span> <span class="kn">import</span> <span class="n">AbstractBaseClass</span>
<span class="kn">from</span> <span class="nn">libpyvinyl.BaseData</span> <span class="kn">import</span> <span class="n">BaseData</span><span class="p">,</span> <span class="n">DataCollection</span>
<span class="kn">from</span> <span class="nn">libpyvinyl.Parameters</span> <span class="kn">import</span> <span class="n">CalculatorParameters</span>


<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span>
    <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%(asctime)s</span><span class="s2"> </span><span class="si">%(levelname)s</span><span class="s2">:</span><span class="si">%(message)s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">WARNING</span>
<span class="p">)</span>


<div class="viewcode-block" id="BaseCalculator"><a class="viewcode-back" href="../../include/refman.html#libpyvinyl.BaseCalculator.BaseCalculator">[docs]</a><span class="k">class</span> <span class="nc">BaseCalculator</span><span class="p">(</span><span class="n">AbstractBaseClass</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    :class BaseCalculator: Base class of all calculators.</span>

<span class="sd">    This class is provides the libpyvinyl API. It defines all methods</span>
<span class="sd">    through which a user interacts with the simulation backengines.</span>

<span class="sd">    This class is to be used as a base class for all calculators that implement</span>
<span class="sd">    a special simulation module, such as a photon diffraction calculator. Such a</span>
<span class="sd">    specialized Calculator has the same interface to the simulation</span>
<span class="sd">    backengine as all other ViNYL Calculators.</span>

<span class="sd">    A Complete example including a instrument and calculators can be found in</span>
<span class="sd">    `test/integration/plusminus`</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="nb">input</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">DataCollection</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="n">BaseData</span><span class="p">],</span>
        <span class="n">output_keys</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
        <span class="n">output_data_types</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
        <span class="n">output_filenames</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">instrument_base_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;./&quot;</span><span class="p">,</span>
        <span class="n">calculator_base_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;BaseCalculator&quot;</span><span class="p">,</span>
        <span class="n">parameters</span><span class="p">:</span> <span class="n">CalculatorParameters</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        :param name: The name of this calculator.</span>
<span class="sd">        :type name: str</span>

<span class="sd">        :param name: The input of this calculator. It can be a `DataCollection`,</span>
<span class="sd">        a list of `DataCollection`s or a single Data Object.</span>
<span class="sd">        :type name: DataCollection, list or BaseData</span>

<span class="sd">        :param output_keys: The key(s) of this calculator&#39;s output data. It&#39;s a list of `str`s or</span>
<span class="sd">        a single str.</span>
<span class="sd">        :type output_keys: list or str</span>

<span class="sd">        :param output_data_types: The data type(s), i.e., classes, of each output. It&#39;s a list of the</span>
<span class="sd">        data classes or a single data class. The available data classes are based on `BaseData`.</span>
<span class="sd">        :type output_data_types: list or DataClass</span>

<span class="sd">        :param output_filenames: The name(s) of the output file(s). It can be a str of a filename or</span>
<span class="sd">        a list of filenames. If the mapping is dict mapping, the name is `None`. Defaults to None.</span>
<span class="sd">        :type output_filenames: list or str</span>

<span class="sd">        :param instrument_base_dir: The base directory for the instrument to which this calculator</span>
<span class="sd">        belongs. Defaults to &quot;./&quot;. The final exact output file path depends on `instrument_base_dir`</span>
<span class="sd">        and `calculator_base_dir`: `instrument_base_dir`/`calculator_base_dir`/filename</span>
<span class="sd">        :type instrument_base_dir: str</span>

<span class="sd">        :param calculator_base_dir: The base directory for this calculator. Defaults to &quot;./&quot;. The final</span>
<span class="sd">        exact output file path depends on `instrument_base_dir` and</span>
<span class="sd">        `calculator_base_dir`: `instrument_base_dir`/`calculator_base_dir`/filename</span>
<span class="sd">        :type instrument_base_dir: str</span>

<span class="sd">        :param parameters: The parameters for this calculator.</span>
<span class="sd">        :type  parameters: Parameters</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Initialize the variables</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__name</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__instrument_base_dir</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__calculator_base_dir</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__input</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__output_keys</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__output_data_types</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__output_filenames</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__parameters</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">input</span> <span class="o">=</span> <span class="nb">input</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_keys</span> <span class="o">=</span> <span class="n">output_keys</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_data_types</span> <span class="o">=</span> <span class="n">output_data_types</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_filenames</span> <span class="o">=</span> <span class="n">output_filenames</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">instrument_base_dir</span> <span class="o">=</span> <span class="n">instrument_base_dir</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculator_base_dir</span> <span class="o">=</span> <span class="n">calculator_base_dir</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span> <span class="o">=</span> <span class="n">parameters</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__check_consistency</span><span class="p">()</span>
        <span class="c1"># Create output data objects according to the output_data_classes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__init_output</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__check_consistency</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check the consistency of the input parameters&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_keys</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_data_types</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;len(output_keys) = </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_keys</span><span class="p">)</span><span class="si">}</span><span class="s2"> is not equal to len(output_data_types) = </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_data_types</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">__check_output_filenames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Since output_filenames can be None for output in dict mapping, only check output_files when necessary&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_data_types</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_filenames</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;len(output_filenames) = </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_filenames</span><span class="p">)</span><span class="si">}</span><span class="s2"> is not equal to len(output_data_types) = </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_data_types</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__name</span>

    <span class="nd">@name</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__name</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Calculator: `name` is expected to be a str, not </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CalculatorParameters</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__parameters</span>

    <span class="nd">@parameters</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">CalculatorParameters</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reset_parameters</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

<div class="viewcode-block" id="BaseCalculator.reset_parameters"><a class="viewcode-back" href="../../include/refman.html#libpyvinyl.BaseCalculator.BaseCalculator.reset_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">reset_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">CalculatorParameters</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Resets the calculator parameters&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">CalculatorParameters</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__parameters</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">elif</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">init_parameters</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Calculator: `parameters` is expected to be CalculatorParameters, not </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span></div>

<div class="viewcode-block" id="BaseCalculator.set_parameters"><a class="viewcode-back" href="../../include/refman.html#libpyvinyl.BaseCalculator.BaseCalculator.set_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args_as_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets parameters contained in this calculator using dict or kwargs</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">args_as_dict</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">parameter_dict</span> <span class="o">=</span> <span class="n">args_as_dict</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">parameter_dict</span> <span class="o">=</span> <span class="n">kwargs</span>

        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">parameter_value</span> <span class="ow">in</span> <span class="n">parameter_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">parameter_value</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">instrument_base_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__instrument_base_dir</span>

    <span class="nd">@instrument_base_dir</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">instrument_base_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_instrument_base_dir</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

<div class="viewcode-block" id="BaseCalculator.set_instrument_base_dir"><a class="viewcode-back" href="../../include/refman.html#libpyvinyl.BaseCalculator.BaseCalculator.set_instrument_base_dir">[docs]</a>    <span class="k">def</span> <span class="nf">set_instrument_base_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the instrument base directory&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__instrument_base_dir</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Calculator: `instrument_base_dir` is expected to be a str, not </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">calculator_base_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__calculator_base_dir</span>

    <span class="nd">@calculator_base_dir</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">calculator_base_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_calculator_base_dir</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

<div class="viewcode-block" id="BaseCalculator.set_calculator_base_dir"><a class="viewcode-back" href="../../include/refman.html#libpyvinyl.BaseCalculator.BaseCalculator.set_calculator_base_dir">[docs]</a>    <span class="k">def</span> <span class="nf">set_calculator_base_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the calculator base directory&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__calculator_base_dir</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Calculator: `calculator_base_dir` is expected to be a str, not </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">input</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataCollection</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__input</span>

    <span class="nd">@input</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_input</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

<div class="viewcode-block" id="BaseCalculator.set_input"><a class="viewcode-back" href="../../include/refman.html#libpyvinyl.BaseCalculator.BaseCalculator.set_input">[docs]</a>    <span class="k">def</span> <span class="nf">set_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">DataCollection</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="n">BaseData</span><span class="p">,</span> <span class="kc">None</span><span class="p">]):</span>
        <span class="sd">&quot;&quot;&quot;Set the calculator input data. It can be a DataCollection, list or BaseData object.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="n">DataCollection</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">))):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__input</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__input</span> <span class="o">=</span> <span class="n">DataCollection</span><span class="p">(</span><span class="o">*</span><span class="n">value</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">BaseData</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__input</span> <span class="o">=</span> <span class="n">DataCollection</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Calculator: `input` can be a DataCollection, list or BaseData object, and will be treated as a DataCollection. Your input type: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="si">}</span><span class="s2"> is not accepted.&quot;</span>
            <span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">output_keys</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__output_keys</span>

    <span class="nd">@output_keys</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">output_keys</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_output_keys</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">base_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The base path for the output files of this calculator in consideration of instrument_base_dir and calculator_base_dir&quot;&quot;&quot;</span>
        <span class="n">base_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">instrument_base_dir</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculator_base_dir</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">base_dir</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">output_file_paths</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The final output file paths considering base_dir&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__check_output_filenames</span><span class="p">()</span>
        <span class="n">paths</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_filenames</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_dir</span><span class="p">)</span> <span class="o">/</span> <span class="n">filename</span>
            <span class="c1"># Make sure the file directory exists</span>
            <span class="n">path</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">paths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">paths</span>

<div class="viewcode-block" id="BaseCalculator.set_output_keys"><a class="viewcode-back" href="../../include/refman.html#libpyvinyl.BaseCalculator.BaseCalculator.set_output_keys">[docs]</a>    <span class="k">def</span> <span class="nf">set_output_keys</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="nb">str</span><span class="p">]):</span>
        <span class="sd">&quot;&quot;&quot;Set the calculator output keys. It can be a list of str or a single str.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
                <span class="k">assert</span> <span class="nb">type</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__output_keys</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__output_keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">value</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Calculator: `output_keys` can be a list or str, and will be treated as a list. Your input type: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="si">}</span><span class="s2"> is not accepted.&quot;</span>
            <span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">output_data_types</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__output_data_types</span>

    <span class="nd">@output_data_types</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">output_data_types</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_output_data_types</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

<div class="viewcode-block" id="BaseCalculator.set_output_data_types"><a class="viewcode-back" href="../../include/refman.html#libpyvinyl.BaseCalculator.BaseCalculator.set_output_data_types">[docs]</a>    <span class="k">def</span> <span class="nf">set_output_data_types</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="n">BaseData</span><span class="p">]):</span>
        <span class="sd">&quot;&quot;&quot;Set the calculator output data type. It can be a list of DataClass or a single DataClass.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
                <span class="k">assert</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">BaseData</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__output_data_types</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">elif</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">BaseData</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__output_data_types</span> <span class="o">=</span> <span class="p">[</span><span class="n">value</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Calculator: `output_data_types` can be a list or a subclass of BaseData, and will be treated as a list. Your input type: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="si">}</span><span class="s2"> is not accepted.&quot;</span>
            <span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">output_filenames</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__output_filenames</span>

    <span class="nd">@output_filenames</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">output_filenames</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_output_filenames</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

<div class="viewcode-block" id="BaseCalculator.set_output_filenames"><a class="viewcode-back" href="../../include/refman.html#libpyvinyl.BaseCalculator.BaseCalculator.set_output_filenames">[docs]</a>    <span class="k">def</span> <span class="nf">set_output_filenames</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]):</span>
        <span class="sd">&quot;&quot;&quot;Set the calculator output filenames. It can be a list of filenames or just a single str.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
                <span class="k">assert</span> <span class="nb">type</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__output_filenames</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">))):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__output_filenames</span> <span class="o">=</span> <span class="p">[</span><span class="n">value</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Calculator: `output_filenames` can be a list or just a str or None, and will be treated as a list. Your input type: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="si">}</span><span class="s2"> is not accepted.&quot;</span>
            <span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">output</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The output of this calculator&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__output</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The alias of output. It&#39;s not recommended to use this variable name due to it&#39;s ambiguity.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__output</span>

<div class="viewcode-block" id="BaseCalculator.init_parameters"><a class="viewcode-back" href="../../include/refman.html#libpyvinyl.BaseCalculator.BaseCalculator.init_parameters">[docs]</a>    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">init_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Virtual method to initialize all parameters. Must be implemented on the</span>
<span class="sd">        specialized class.&quot;&quot;&quot;</span>

        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div>

    <span class="k">def</span> <span class="nf">__init_output</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create output data objects according to the output_data_types&quot;&quot;&quot;</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">DataCollection</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_keys</span><span class="p">):</span>
            <span class="n">output_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_data_types</span><span class="p">[</span><span class="n">i</span><span class="p">](</span><span class="n">key</span><span class="p">)</span>
            <span class="n">output</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span><span class="n">output_data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__output</span> <span class="o">=</span> <span class="n">output</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The copy constructor</span>

<span class="sd">        :param parameters: The parameters for the new calculator.</span>
<span class="sd">        :type  parameters: CalculatorParameters</span>

<span class="sd">        :param kwargs: key-value pairs of parameters to change in the new instance.</span>

<span class="sd">        :return: A new parameters instance with optionally changed parameters.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">new</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="n">new</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">parameters</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">new</span><span class="o">.</span><span class="n">parameters</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">new</span><span class="o">.</span><span class="n">parameters</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new</span><span class="o">.</span><span class="n">parameters</span> <span class="o">=</span> <span class="n">parameters</span>
        <span class="k">return</span> <span class="n">new</span>

<div class="viewcode-block" id="BaseCalculator.from_dump"><a class="viewcode-back" href="../../include/refman.html#libpyvinyl.BaseCalculator.BaseCalculator.from_dump">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_dump</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">dumpfile</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Load a dill dump from a dumpfile.</span>

<span class="sd">        :param dumpfile: The file name of the dumpfile.</span>
<span class="sd">        :type dumpfile: str</span>
<span class="sd">        :return: The calculator object restored from the dumpfile.</span>
<span class="sd">        :rtype: CalcualtorClass</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">dumpfile</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fhandle</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">tmp</span> <span class="o">=</span> <span class="n">dill</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fhandle</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">&quot;Cannot load calculator from </span><span class="si">{}</span><span class="s2">.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dumpfile</span><span class="p">))</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The object in the file </span><span class="si">{</span><span class="n">dumpfile</span><span class="si">}</span><span class="s2"> is not a </span><span class="si">{</span><span class="bp">cls</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">tmp</span></div>

<div class="viewcode-block" id="BaseCalculator.dump"><a class="viewcode-back" href="../../include/refman.html#libpyvinyl.BaseCalculator.BaseCalculator.dump">[docs]</a>    <span class="k">def</span> <span class="nf">dump</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fname</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Dump class instance to file.</span>

<span class="sd">        :param fname: Filename (path) of the file to write.</span>
<span class="sd">        :type fname: str</span>

<span class="sd">        :return: The filename of the dumpfile</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">fname</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">fname</span> <span class="o">=</span> <span class="n">mkstemp</span><span class="p">(</span>
                <span class="n">suffix</span><span class="o">=</span><span class="s2">&quot;_dump.dill&quot;</span><span class="p">,</span>
                <span class="n">prefix</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                <span class="nb">dir</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span>
            <span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file_handle</span><span class="p">:</span>
            <span class="n">dill</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_handle</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">fname</span></div>

<div class="viewcode-block" id="BaseCalculator.backengine"><a class="viewcode-back" href="../../include/refman.html#libpyvinyl.BaseCalculator.BaseCalculator.backengine">[docs]</a>    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">backengine</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div></div>


<span class="c1"># This project has received funding from the European Union&#39;s Horizon 2020 research and innovation programme under grant agreement No. 823852.</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020-2021, Carsten Fortmann-Grote, Mads Bertelsen, Juncheng E, Shervin Nourbakhsh.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   <jinja2.runtime.BlockReference object at 0x7f85423f2be0>
<br/>
<br/>
<p>
 <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">
  <img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" />
 </a>
    This documentation is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License.</a>
</p>
    <p>
    The software
    <i>libpyvinyl</i> is licensed under the <a href="https://github.com/PaNOSC-ViNYL/libpyvinyl/blob/master/LICENSE">LGPL version 3 or later</a>.
</p>
<p>
This project has received funding from the European Union's Horizon 2020 research and innovation programme under grant agreement No. 823852
    <a rel="panosc" href="https://panosc.eu">
      <img alt="Photon and Neutron Open Science Cloud" style="border-width:0" src="https://github.com/panosc-eu/panosc/blob/master/Logos%20and%20Templates/Logos/PaNOSC/PaNOSClogo_web_RGB.jpg" />
    </a>
</p>


</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>